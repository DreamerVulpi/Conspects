#####11.03.2020
####Филатыч
#####Тема лекции №3: "Обход графа"
***
**Обход графа в глубину: три цвета**

В ряде случаев используют три цвета окраски (маркировки) вершин
* **Белая (mark [v] = 0)**, если вершина не посещалась, т.е к ней процедура dfs() не применялась;
* **Серая (mark [v] = 1)**, если вершина посещается, т.е обработка всех смежных с ней вершин не завершена;
* **Чёрная (mark [v] = 2)**, если для данной вершины обработка всех смежных с ней вершин завершено.

```псевдокод
Поиск (u) 
{
    цвет [u] <- серый;
    d[u] = time++; //время входа в вершину,
    //порядкой глубинный номер вершины
    для любого множества принадлежащее смежные (u) выполнить
    {
        если (цвет[v] = белый) то
        {
        отец [v] <- u;
            Поиск(v);
        }
    }
    цвет[u] <- чёрный;
    f[u] <- time++; //время выхода из вершины
}
```

**Обход графа: построение глубинного остовного леса (ГОЛ)**

Поиск в глубину в ориентированном графе G разбивает множество его ребёр на четыре класса.

1) **Древесные рёбра**, идушие к новым узлам в процессе поиска. (ребро дерева);
2) **Прямые рёбра**, идущие от предков к подлинным потомкам, но не являющиеся древесными рёбрами.;
3) **Обратные рёбра**, идущие от потомков к предкам (возможно, из узла в себя).;
4) **Поперечные рёбра**, соединяющие узлы, которые не являются ни предками, ни потомками друг друга.

**Анализ**

Общее число операций при выполнении
    
    Поиск в графе:
        O(|V|)

Общее число операций при выполнении Поиск(u):
    
    Цикл выполняется |смежные[v]| раз.
    |смежные[v]| = O(|E|)
    
Общее число операций: 
    
    O(|V|+|E|)

**Свойства поиска в глубину**

*Теорема*

При поиске в глубину в графе G = (V, E) для любых двух вершин u и v выполняется одно из следующих утверждений:
    
 1) Отрезки [d[u], f[u]] и [d[v], f[v]] не пересекаются.
 2) Отрезок [d[u], f[u]] целиком содержится внутри отрезка [d[v], f[v]] и u есть потомок v в дереве поиска в глубину.
 3) Отрезок [d[v], f[v]] целиком содержится внутри отрезка [d[u], f[u]] и v есть потомок u в дереве поиска в глубину.
    
**Обход в ширину**

```псевдокод
Алгоритм
Инициализация
для (любого u принадлежащее (V\{s}) выполнить
{
    цвет[u] <- белый;
    предок[u] <- NULL;
    d[u] <- infinity;
}
d[s] <- 0;
предок[s] <- NULL;
put(s,Q);
```

```псевдокод
пока (Q != круг с полосочкой) выполнить
{
    u <- first(Q);
    для (любого множества принадлежащее смежные[u]) выполнить
    {
        если (цвет[v] = белый) то
        {
        цвет[v] <- серый;
        предок[v] <- u;
        d[v] <- d[u]+1;
        put(v,Q);
        }  
    get(Q);
    цвет[u] <- чёрный;
}
```

> d - массив длин